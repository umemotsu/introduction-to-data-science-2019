---
title: Q&A
date: 2019-12-01T13:17:57+09:00
weight: 2
---

## 座学全般

### 最初の話のスピードが速すぎて追いつくのがつらい

すみません。インタラプトがないと早口になりがちなので、追いつけなくなったら止めてください。

### 例が豊富で分かりやすかった

この講義は概論なので、手法の細部よりも、それがどういう目的が使われるか、どう振る舞うのかを大まかに理解してもらえれば十分なのかと思っています。次回も引き続き、例を多めに説明する予定です。

## トピックモデル

### トピックモデルのトピック数はどのように決定すればいい？

タスクの種類やデータセットの大きさによって適切なトピック数は異なるので、その値を決定するのは重要な問題です。

一つの方法として、perplexityと呼ばれる評価指標を使うことができます。Perplexityの定義は次回に説明しますが、直感的にはこの値は予測対象の単語を何候補まで絞り込めるかを表しており、低いほど（この指標において）良いモデルということができます。この指標を用いた場合の手順は、

1. 事前にデータセットを訓練用・開発用・テスト用に分割する
2. ハイパーパラメータ（トピック数など）を変えながら訓練データを用いて複数のモデルを学習する
3. 開発用データにおけるperplexityの値が最良となるモデルを選択する。

となります。開発用データを準備せず、訓練用とテスト用の2つに分けて、ハイパーパラメータを決定することもできますが、その場合、テスト用データにオーバーフィッティングする可能性があります。

別の評価指標として、coherence[^Newman+-2010]と呼ばれるものもあります。Perplexityが汎化能力（未知データに対する予測性能）を測るのに対して、coherenceは学習された各トピックにおける頻出単語の一貫性を所与の単語間類似度関数を用いて評価します。これも次回に簡単に紹介しますが、Wikipediaから学習した自己相互情報量（Pointwise Mutual Information; PMI）を単語間類似度として用いる方法が、人手による判定結果との相関が最も高いと報告されています。

[^Newman+-2010]: David Newman, Jey Han Lau, Karl Grieser, and Timothy Baldwin. 2010. Automatic evaluation of topic coherence. In Human Language Technologies: The 2010 Annual Conference of the North American Chapter of the Association for Computational Linguistics (HLT '10). Association for Computational Linguistics, Stroudsburg, PA, USA, 100-108.

LDAによる学習結果を別のタスクに利用する場合は、そのタスクにおける性能をモデルの良さとして評価できます。例えば、文書のカテゴリ分類という問題に対して、LDAによって学習したトピック分布を各文書の特徴ベクトルとして、SVMなどの分類モデルを学習することが1つのアプローチとして考えられます。この場合は、perplexityの時と同様に、開発 or テスト用の文書集合を用意して、それらに対する分類精度を比較することで、当該問題に最適なLDAモデルのトピック数を決定することができます。

より発展的な話題として、学習時にはトピック数を設定せず、データから最適な値を自動で学習するという方法も研究されています。このような「無限次元空間における統計モデル」（これは厳密な説明ではないかもしれません）はノンパラメトリックベイズモデルと呼ばれます。既存のトピックを割り当てるか、新規にトピックを作るかを決める方法の一つとして、中華料理店過程（Chinese Restaurant Process; CRP）と呼ばれる確率過程が存在します。ノンパラメトリックベイズに興味のある人は、[この本](https://www.kspub.co.jp/book/detail/1529151.html)が参考になるかもしれません。

## 確率的投薬モデル

### トピックモデルにおけるトピックは、このモデルでは疾患に対応している？

そうです。より正確に言うと、このモデルの潜在変数である$z\_{rl}$は、$r$番目のレセプトにおいて$l$番目に処方された医薬品$m\_{rl}$の対象が、当該レセプトにおいて診断された全疾患$\\{d\_{rn}\\}\_{n=1}^{N_{r}}$のうち、どれに対応するかを表しています。

### グラフィカルモデル中の$d\_{rn}$と$N\_{r}$は何を意味している？

それぞれ以下のとおりです。

- $d\_{rn}$: $r$番目のレセプトにおいて$n$番目に診断された疾患
- $N\_{r}$: $r$番目のレセプトにおいて診断された疾患の数


## 演習全般

### コードが分からなくても簡単に理解できる

座学で説明した手法を実際に適用したらどうなるかを分かってもらうのが演習の大事な目標の1つなので、次回も適用事例のノートブックを1つは準備したいと思います。

### 各自で作業する感じの方が楽しいかも

特にプログラミングに慣れている人にとってはこういうニーズもあると思いますので、次回は手を動かしてもらう課題も用意しようかと思います。
